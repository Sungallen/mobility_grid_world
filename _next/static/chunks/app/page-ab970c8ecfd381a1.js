(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{9656:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>J});var s=t(5155),a=t(2115),n=t(2467),o=t(3101),l=t(2821),d=t(5889);function i(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,d.QP)((0,l.$)(r))}let c=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function u(e){let{className:r,variant:t,size:a,asChild:o=!1,...l}=e,d=o?n.DX:"button";return(0,s.jsx)(d,{"data-slot":"button",className:i(c({variant:t,size:a,className:r})),...l})}function x(e){let{className:r,...t}=e;return(0,s.jsx)("div",{"data-slot":"card",className:i("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",r),...t})}function g(e){let{className:r,...t}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:i("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",r),...t})}function m(e){let{className:r,...t}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:i("leading-none font-semibold",r),...t})}function h(e){let{className:r,...t}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:i("px-6",r),...t})}function f(e){let{className:r,type:t,...a}=e;return(0,s.jsx)("input",{type:t,"data-slot":"input",className:i("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",r),...a})}var p=t(489);function v(e){let{className:r,...t}=e;return(0,s.jsx)(p.b,{"data-slot":"label",className:i("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",r),...t})}var b=t(5763),j=t(4033),N=t(5917),y=t(2108);function w(e){let{...r}=e;return(0,s.jsx)(b.bL,{"data-slot":"select",...r})}function k(e){let{...r}=e;return(0,s.jsx)(b.WT,{"data-slot":"select-value",...r})}function _(e){let{className:r,size:t="default",children:a,...n}=e;return(0,s.jsxs)(b.l9,{"data-slot":"select-trigger","data-size":t,className:i("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",r),...n,children:[a,(0,s.jsx)(b.In,{asChild:!0,children:(0,s.jsx)(j.A,{className:"size-4 opacity-50"})})]})}function C(e){let{className:r,children:t,position:a="popper",...n}=e;return(0,s.jsx)(b.ZL,{children:(0,s.jsxs)(b.UC,{"data-slot":"select-content",className:i("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:a,...n,children:[(0,s.jsx)(S,{}),(0,s.jsx)(b.LM,{className:i("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),(0,s.jsx)(A,{})]})})}function M(e){let{className:r,children:t,...a}=e;return(0,s.jsxs)(b.q7,{"data-slot":"select-item",className:i("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",r),...a,children:[(0,s.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(b.VF,{children:(0,s.jsx)(N.A,{className:"size-4"})})}),(0,s.jsx)(b.p4,{children:t})]})}function S(e){let{className:r,...t}=e;return(0,s.jsx)(b.PP,{"data-slot":"select-scroll-up-button",className:i("flex cursor-default items-center justify-center py-1",r),...t,children:(0,s.jsx)(y.A,{className:"size-4"})})}function A(e){let{className:r,...t}=e;return(0,s.jsx)(b.wn,{"data-slot":"select-scroll-down-button",className:i("flex cursor-default items-center justify-center py-1",r),...t,children:(0,s.jsx)(j.A,{className:"size-4"})})}var z=t(5870),I=t(1696),F=t(1360),E=t(5530),L=t(5993),R=t(2263),H=t(9474),P=t(6667),W=t(8707),$=t(5921),O=t(4466),B=t(7755),D=t(7734),T=t(3697),V=t(3667),U=t(8453);function G(e,r){return"".concat(e,",").concat(r)}function K(e,r,t){return Math.max(r,Math.min(t,e))}function q(){let[e,r]=(0,a.useState)(18),[t,n]=(0,a.useState)(24),[o,l]=(0,a.useState)(50),[d,i]=(0,a.useState)(()=>new Set),[c,p]=(0,a.useState)([]),[b,j]=(0,a.useState)(2100),[N,y]=(0,a.useState)(800),[S,A]=(0,a.useState)(.2),[q,J]=(0,a.useState)(0),[Q,X]=(0,a.useState)(35),[Z,Y]=(0,a.useState)(4.8),[ee,er]=(0,a.useState)("road"),[et,es]=(0,a.useState)(80),[ea,en]=(0,a.useState)(200),[eo,el]=(0,a.useState)(15),[ed,ei]=(0,a.useState)(5e6),[ec,eu]=(0,a.useState)(0),[ex,eg]=(0,a.useState)(13e3),[em,eh]=(0,a.useState)(1.5),[ef,ep]=(0,a.useState)(1.6),[ev,eb]=(0,a.useState)(6),[ej,eN]=(0,a.useState)(5e4),ey=(e,r)=>{let t=e>ev?ej*Math.pow(e-ev,2):0;return Math.round(ex*Math.pow(r,em)*Math.pow(e,ef)+t)},[ew,ek]=(0,a.useState)("road"),[e_,eC]=(0,a.useState)("draw"),[eM,eS]=(0,a.useState)(3),[eA,ez]=(0,a.useState)(12),eI=(0,a.useRef)(!1),[eF,eE]=(0,a.useState)(""),eL=(0,a.useMemo)(()=>c.filter(e=>"house"===e.kind).reduce((e,r)=>e+r.floors*r.baseCapacity,0),[c]),eR=(0,a.useMemo)(()=>c.filter(e=>"work"===e.kind).length,[c]),eH=(0,a.useMemo)(()=>2e6*eR,[eR]),eP=(0,a.useMemo)(()=>c.filter(e=>"food"===e.kind).length,[c]),eW=26*t,e$=26*e;function eO(e,r,t){i(s=>{let a=new Set(s),n=G(e,r);return void 0===t?a.has(n)?a.delete(n):a.add(n):t?a.add(n):a.delete(n),a})}function eB(e,r){p(t=>{let s=t.findIndex(t=>t.r===e&&t.c===r);if(-1===s)return t;let a=t[s];if("house"===a.kind){let e=ey(a.floors,a.baseCapacity);eu(r=>Math.max(0,r-e))}let n=[...t];return n.splice(s,1),n}),i(t=>{let s=new Set(t);return s.delete(G(e,r)),s})}(0,a.useEffect)(()=>{let e=new Set;for(let r=0;r<25;r++)if(r%3==0)for(let t=0;t<30;t++)e.add(G(r,t));for(let r=0;r<30;r++)if(r%3==0)for(let t=0;t<25;t++)e.add(G(t,r));let t=new Set,s=[],a=(r,a,n,o,l)=>{let d=G(a,n);return!(e.has(d)||t.has(d))&&(t.add(d),s.push({kind:r,r:a,c:n,floors:o,baseCapacity:l}),!0)},o=0,l=Math.floor(15),d=Math.floor(12);for(let e=24;e>=l&&o<117;e--)for(let r=d-1;r>=0&&o<117;r--)a("house",e,r,3,6)&&o++;for(let e=24;e>=0&&o<117;e--)for(let r=29;r>=0&&o<117;r--)a("house",e,r,3,6)&&o++;o=0;let c=Math.floor(10),u=Math.floor(18);for(let e=0;e<c&&o<32;e++)for(let r=u;r<30&&o<32;r++)a("work",e,r,1,30)&&o++;for(let e=0;e<25&&o<32;e++)for(let r=0;r<30&&o<32;r++)a("work",e,r,1,30)&&o++;let x=[];for(let e=0;e<25;e++)for(let r=0;r<30;r++)x.push(G(e,r));for(let e=x.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1));[x[e],x[r]]=[x[r],x[e]]}for(let r of(o=0,x)){if(o>=11)break;if(e.has(r)||t.has(r))continue;let[s,n]=r.split(",").map(Number);a("food",s,n,1,50)&&o++}let g=0;for(let e of s)"house"===e.kind&&(g+=ey(e.floors,e.baseCapacity));r(25),n(30),j(2100),ei(75e6),eh(1.5),eS(3),eg(13e3),ez(6),eu(g),i(e),p(s),eE("")},[]);let[eD,eT]=(0,a.useState)(null),eV=(e,r)=>{"road"===ew&&"line"===e_&&eD&&void 0!==e&&void 0!==r&&((function(e,r){let t=[],s=e.r<=r.r?1:-1;for(let a=e.r;a!==r.r+s;a+=s)t.push({r:a,c:e.c});let a=e.c<=r.c?1:-1;for(let s=e.c;s!==r.c+a;s+=a)t.push({r:r.r,c:s});return t})(eD,{r:e,c:r}).forEach(e=>eO(e.r,e.c,!0)),eT(null)),eI.current=!1},[eU,eG]=(0,a.useState)(null),eK=(0,a.useMemo)(()=>eU?[{metric:"Avg walk (m)",value:eU.avg_walk_m_per_day},{metric:"Avg drive (m)",value:eU.avg_drive_m_per_day},{metric:"Avg time (min)",value:eU.avg_travel_time_min_per_day},{metric:"Total CO₂ (kg)",value:eU.total_emissions_kg_per_day}]:[],[eU]);return(0,s.jsx)("div",{className:"w-full min-h-screen p-4 md:p-6 lg:p-8 bg-background text-foreground",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"lg:col-span-1 space-y-4",children:[(0,s.jsxs)(x,{className:"bg-card border-border text-card-foreground",children:[(0,s.jsx)(g,{children:(0,s.jsxs)(m,{className:"flex items-center gap-2",children:[(0,s.jsx)(z.A,{className:"w-5 h-5"})," World & Tools"]})}),(0,s.jsxs)(h,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Rows"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:e,min:6,max:40,onChange:e=>r(K(parseInt(e.target.value||"0"),6,40))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Cols"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:t,min:6,max:40,onChange:e=>n(K(parseInt(e.target.value||"0"),6,40))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Cell (m)"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:o,min:10,max:200,onChange:e=>l(K(parseInt(e.target.value||"0"),10,200))})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(u,{variant:"road"===ew?"default":"secondary",onClick:()=>ek("road"),children:[(0,s.jsx)(I.A,{className:"w-4 h-4 mr-1"}),"Road"]}),(0,s.jsxs)(u,{variant:"erase"===ew?"default":"secondary",onClick:()=>ek("erase"),children:[(0,s.jsx)(F.A,{className:"w-4 h-4 mr-1"}),"Erase"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(w,{value:e_,onValueChange:e=>eC(e),children:[(0,s.jsx)(_,{className:"w-[120px] bg-input border-border text-foreground",children:(0,s.jsx)(k,{})}),(0,s.jsxs)(C,{children:[(0,s.jsx)(M,{value:"draw",children:"Draw"}),(0,s.jsx)(M,{value:"line",children:"Line"})]})]}),(0,s.jsxs)(u,{variant:"secondary",onClick:()=>{i(r=>{let s=new Set(r);for(let r=0;r<e;r++)if(r%3==0)for(let e=0;e<t;e++)s.add(G(r,e));for(let r=0;r<t;r++)if(r%3==0)for(let t=0;t<e;t++)s.add(G(t,r));return s})},children:[(0,s.jsx)(E.A,{className:"w-4 h-4 mr-1"}),"Auto Grid"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,s.jsxs)(u,{variant:"house"===ew?"default":"secondary",onClick:()=>ek("house"),children:[(0,s.jsx)(L.A,{className:"w-4 h-4 mr-1"}),"House"]}),(0,s.jsxs)(u,{variant:"work"===ew?"default":"secondary",onClick:()=>ek("work"),children:[(0,s.jsx)(R.A,{className:"w-4 h-4 mr-1"}),"Work"]}),(0,s.jsxs)(u,{variant:"food"===ew?"default":"secondary",onClick:()=>ek("food"),children:[(0,s.jsx)(H.A,{className:"w-4 h-4 mr-1"}),"Food"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Floors (for placement)"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:eM,min:1,max:30,onChange:e=>eS(K(parseInt(e.target.value||"0"),1,30))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Base capacity"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:eA,min:1,max:200,onChange:e=>ez(K(parseInt(e.target.value||"0"),1,200))})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-1",children:[(0,s.jsxs)(u,{variant:"secondary",onClick:()=>{p([]),i(new Set),j(250),y(800),X(35),Y(4.8),A(.2),J(0),ei(5e6),eu(0);let r=new Set;for(let s=0;s<e;s++)if(s%3==0)for(let e=0;e<t;e++)r.add(G(s,e));for(let s=0;s<t;s++)if(s%3==0)for(let t=0;t<e;t++)r.add(G(t,s));i(r);let s=[],a=(e,r,t,a,n)=>s.push({kind:e,r,c:t,floors:a,baseCapacity:n});[[2,2],[2,8],[2,14],[8,2],[8,8],[8,14]].forEach((e,r)=>a("house",e[0],e[1],2+r%3,12)),[[14,2],[14,8],[14,14]].forEach((e,r)=>a("work",e[0],e[1],4+r%2,30)),[[11,5],[5,11],[17,11]].forEach(e=>a("food",e[0],e[1],1,50)),p(s)},children:[(0,s.jsx)(P.A,{className:"w-4 h-4 mr-1"}),"Load Demo"]}),(0,s.jsxs)(u,{variant:"secondary",onClick:()=>{p([]),i(new Set),eG(null),eu(0)},children:[(0,s.jsx)(F.A,{className:"w-4 h-4 mr-1"}),"Clear All"]})]})]})]}),(0,s.jsxs)(x,{className:"bg-card border-border text-card-foreground",children:[(0,s.jsx)(g,{children:(0,s.jsxs)(m,{className:"flex items-center gap-2",children:[(0,s.jsx)(W.A,{className:"w-5 h-5"})," Mobility Settings"]})}),(0,s.jsxs)(h,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Population"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:b,min:0,max:1e4,onChange:e=>j(K(parseInt(e.target.value||"0"),0,1e4))}),(0,s.jsxs)("p",{className:"text-muted-foreground text-xs mt-1",children:["Housing cap: ",eL]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Walk threshold (m)"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:N,min:0,max:1e5,onChange:e=>y(K(parseInt(e.target.value||"0"),0,1e5))})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Car speed (km/h)"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:Q,min:1,max:200,onChange:e=>X(K(parseInt(e.target.value||"0"),1,200))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Walk speed (km/h)"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:Z,min:1,max:20,onChange:e=>Y(K(parseInt(e.target.value||"0"),1,20))})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Car CO₂ (kg/km)"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",step:"0.01",value:S,onChange:e=>A(parseFloat(e.target.value||"0"))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Walk CO₂ (kg/km)"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",step:"0.01",value:q,onChange:e=>J(parseFloat(e.target.value||"0"))})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Distance mode"}),(0,s.jsxs)(w,{value:ee,onValueChange:e=>er(e),children:[(0,s.jsx)(_,{className:"w-full bg-input border-border text-foreground",children:(0,s.jsx)(k,{})}),(0,s.jsxs)(C,{children:[(0,s.jsx)(M,{value:"road",children:"Road (BFS)"}),(0,s.jsx)(M,{value:"euclid",children:"Euclidean"}),(0,s.jsx)(M,{value:"manhattan",children:"Manhattan"})]})]})]})}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Boundary CO₂ penalty (kg/person)"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",step:"0.1",value:eo,onChange:e=>el(parseFloat(e.target.value||"0"))}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs mt-1",children:"Applied to inbound + outbound commuters due to jobs–housing imbalance."})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Jobs / workplace"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:et,min:1,onChange:e=>es(Math.max(1,parseInt(e.target.value||"1")))}),(0,s.jsxs)("p",{className:"text-muted-foreground text-xs mt-1",children:["Have ",eR,", need ",Math.ceil(b/Math.max(1,et))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"People / food place"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:ea,min:1,onChange:e=>en(Math.max(1,parseInt(e.target.value||"1")))}),(0,s.jsxs)("p",{className:"text-muted-foreground text-xs mt-1",children:["Have ",eP,", need ",Math.ceil(b/Math.max(1,ea))]})]})]}),(0,s.jsx)("div",{className:"pt-2 text-right",children:(0,s.jsxs)(u,{onClick:function(){let r=c.filter(e=>"house"===e.kind),s=c.filter(e=>"work"===e.kind),a=c.filter(e=>"food"===e.kind);if(!r.length)return eE("Place at least one house.");if(!s.length)return eE("Place at least one workplace.");if(!a.length)return eE("Place at least one food place.");let n=r.reduce((e,r)=>e+r.floors*r.baseCapacity,0);if(n<b)return eG(null),eE("Not enough housing capacity (".concat(n,") for population (").concat(b,"). Raise floors, base capacity, or add houses."));let l=Math.ceil(b/Math.max(1,et)),i=Math.ceil(b/Math.max(1,ea));if(s.length<l)return eG(null),eE("Insufficient workplaces: have ".concat(s.length,", need ").concat(l,"."));if(a.length<i)return eG(null),eE("Insufficient food places: have ".concat(a.length,", need ").concat(i,"."));let u=eR*Math.max(1,et),x=Math.max(0,u-b),g=Math.max(0,b-u),m=Array.from({length:b},(e,r)=>({id:r})),h=r.flatMap(e=>Array(e.floors*e.baseCapacity).fill(e)),f=0;m.forEach(e=>{e.house=h[f++]}),m.forEach(e=>{e.work=s[Math.floor(Math.random()*s.length)],e.food=a[Math.floor(Math.random()*a.length)]});let p=0,v=0,j=0,y=0,w=0,k=0;for(let r of m){let s=[[{r:r.house.r,c:r.house.c},{r:r.work.r,c:r.work.c}],[{r:r.work.r,c:r.work.c},{r:r.food.r,c:r.food.c}],[{r:r.food.r,c:r.food.c},{r:r.house.r,c:r.house.c}]],a=!1;for(let r=0;r<3;r++){let[n,l]=s[r],i=function(r,s){if("euclid"===ee)return Math.hypot(r.r-s.r,r.c-s.c)*o;if("manhattan"===ee)return(Math.abs(r.r-s.r)+Math.abs(r.c-s.c))*o;let a=function(e,r,t,s,a){let n=(t,s)=>t>=0&&s>=0&&t<e&&s<r,o=e=>{let r=G(e.r,e.c);if(t.has(r))return r;let s=[e],a=new Set([r]);for(;s.length;){let e=s.shift();for(let r of[{r:e.r+1,c:e.c},{r:e.r-1,c:e.c},{r:e.r,c:e.c+1},{r:e.r,c:e.c-1}]){if(!n(r.r,r.c))continue;let e=G(r.r,r.c);if(!a.has(e)){if(t.has(e))return e;a.add(e),s.push(r)}}}return null},l=o(s),d=o(a);if(!l||!d)return null;if(l===d)return 0;let i=[l],c=new Map([[l,0]]),u=[[1,0],[-1,0],[0,1],[0,-1]];for(;i.length;){let e=i.shift(),[r,s]=e.split(",").map(Number);for(let[a,o]of u){var x;let l=r+a,u=s+o;if(!n(l,u))continue;let g=G(l,u);if(!(!t.has(g)||c.has(g))){if(c.set(g,(null!=(x=c.get(e))?x:0)+1),g===d)return c.get(g);i.push(g)}}}return null}(e,t,d,r,s);return null===a?null:a*o}(n,l);if(null===i||!isFinite(i)){k++,a=!0;continue}let c=i>N,u=c?Q:Z,x=c?S:q;j+=i/1e3/Math.max(u,1e-6),y+=i/1e3*x,c?(v+=i,a=!0):p+=i}a&&w++}eG({population:b,avg_walk_m_per_day:p/Math.max(b,1),avg_drive_m_per_day:v/Math.max(b,1),avg_travel_time_min_per_day:j/Math.max(b,1)*60,total_emissions_kg_per_day:y+(x+g)*Math.max(0,eo),drivers_count:w,unreachable_legs:k,travel_in:x,travel_out:g}),eE("")},children:[(0,s.jsx)($.A,{className:"w-4 h-4 mr-1"}),"Run Simulation"]})}),eF&&(0,s.jsx)("p",{className:"text-sm text-red-400",children:eF})]})]}),(0,s.jsxs)(x,{className:"bg-card border-border text-card-foreground",children:[(0,s.jsx)(g,{children:(0,s.jsx)(m,{children:"Budget & Constraints"})}),(0,s.jsxs)(h,{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Budget ($)"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:ed,onChange:e=>ei(parseInt(e.target.value||"0"))})]}),(0,s.jsxs)("div",{className:"pt-6 text-muted-foreground text-sm",children:["Spent: $",ec.toLocaleString()]}),(0,s.jsxs)("div",{className:"pt-6 text-muted-foreground text-sm",children:["Remain: $",(ed+eH-ec).toLocaleString()]})]}),(0,s.jsxs)("div",{className:"col-span-3 text-neutral-400 text-xs",children:["Revenue from workplaces: $",eH.toLocaleString()," (adds to budget)"]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Base cost"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:ex,onChange:e=>eg(parseInt(e.target.value||"0"))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Hi-rise threshold (floors)"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:ev,onChange:e=>eb(parseInt(e.target.value||"0"))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Capacity exponent"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",step:"0.1",value:em,onChange:e=>eh(parseFloat(e.target.value||"0"))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Hi-rise penalty"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",value:ej,onChange:e=>eN(parseInt(e.target.value||"0"))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v,{className:"text-foreground",children:"Floors exponent"}),(0,s.jsx)(f,{className:"bg-input border-border text-foreground placeholder-muted-foreground focus-visible:ring-ring",type:"number",step:"0.1",value:ef,onChange:e=>ep(parseFloat(e.target.value||"0"))})]}),(0,s.jsx)("div",{className:"pt-6 text-right",children:(0,s.jsx)(u,{variant:"secondary",onClick:()=>eu(0),children:"Reset Spent"})})]}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["House cost preview (floors ",eM,", base cap ",eA,") ≈ $",ey(eM,eA).toLocaleString()]})]})]})]}),(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,s.jsxs)(x,{className:"bg-card border-border text-card-foreground",children:[(0,s.jsx)(g,{children:(0,s.jsxs)(m,{className:"flex items-center gap-2",children:[(0,s.jsx)(E.A,{className:"w-5 h-5"}),"Grid World"]})}),(0,s.jsxs)(h,{children:[(0,s.jsxs)("div",{className:"relative select-none rounded-xl overflow-hidden shadow-inner",onMouseLeave:()=>eV(),style:{width:eW,height:e$},children:[[...Array(e)].map((e,r)=>(0,s.jsx)("div",{className:"absolute left-0 right-0 border-t border-border",style:{top:26*r}},r)),[...Array(t)].map((e,r)=>(0,s.jsx)("div",{className:"absolute top-0 bottom-0 border-l border-border",style:{left:26*r}},r)),(0,s.jsx)("div",{className:"absolute inset-0",onMouseUp:()=>eV(),children:[...Array(e)].map((e,r)=>(0,s.jsx)("div",{className:"flex",style:{position:"absolute",top:26*r},children:[...Array(t)].map((e,t)=>{let a=G(r,t),n=d.has(a),o=c.find(e=>e.r===r&&e.c===t);return(0,s.jsxs)("div",{onMouseDown:()=>((e,r)=>{if(eI.current=!0,eE(""),"road"===ew)"draw"===e_?eO(e,r,!0):eT({r:e,c:r});else if("erase"===ew)eB(e,r);else p(t=>{if(t.some(t=>t.r===e&&t.c===r))return t;if("house"===ew){let e=ey(eM,eA),r=ed+eH-ec;if(e>r)return eE("Not enough budget for this house. Cost $".concat(e.toLocaleString()," | Remaining $").concat((r-e).toLocaleString())),t;eu(r=>r+e)}return i(t=>{let s=new Set(t);return s.delete(G(e,r)),s}),[...t,{kind:ew,r:e,c:r,floors:eM,baseCapacity:eA}]})})(r,t),onMouseEnter:()=>{eI.current&&("road"===ew&&"draw"===e_&&eO(r,t,!0),"erase"===ew&&eB(r,t))},onMouseUp:()=>eV(r,t),className:"relative",style:{width:26,height:26,cursor:"crosshair"},children:[n&&(0,s.jsx)("div",{className:"absolute inset-0 bg-muted"}),o&&(0,s.jsx)("div",{className:"absolute inset-[3px] rounded-md flex items-center justify-center text-[10px] font-medium ".concat("house"===o.kind?"bg-emerald-600":"work"===o.kind?"bg-blue-600":"bg-amber-600"),title:"".concat(o.kind," | floors ").concat(o.floors," | cap ").concat(o.floors*o.baseCapacity),children:"house"===o.kind?"H":"work"===o.kind?"W":"F"})]},t)})},r))})]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Tip: choose a tool (Road/Erase/House/Work/Food). Hold and drag to draw roads. Switch to ",(0,s.jsx)("em",{children:"Line"})," to lay L-shaped roads."]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[(0,s.jsxs)(x,{className:"bg-card border-border text-card-foreground",children:[(0,s.jsx)(g,{children:(0,s.jsx)(m,{children:"Metrics"})}),(0,s.jsx)(h,{children:eU?(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{className:"p-3 rounded-xl bg-muted",children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"Population"}),(0,s.jsx)("div",{className:"text-xl font-semibold",children:eU.population})]}),(0,s.jsxs)("div",{className:"p-3 rounded-xl bg-muted",children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"Drivers"}),(0,s.jsx)("div",{className:"text-xl font-semibold",children:eU.drivers_count})]}),(0,s.jsxs)("div",{className:"p-3 rounded-xl bg-muted",children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"Unreachable legs"}),(0,s.jsx)("div",{className:"text-xl font-semibold",children:eU.unreachable_legs})]}),(0,s.jsxs)("div",{className:"p-3 rounded-xl bg-muted",children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"Avg time / day"}),(0,s.jsxs)("div",{className:"text-xl font-semibold",children:[eU.avg_travel_time_min_per_day.toFixed(1)," min"]})]}),(0,s.jsxs)("div",{className:"p-3 rounded-xl bg-muted",children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"Avg walk / day"}),(0,s.jsxs)("div",{className:"text-xl font-semibold",children:[eU.avg_walk_m_per_day.toFixed(0)," m"]})]}),(0,s.jsxs)("div",{className:"p-3 rounded-xl bg-muted",children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"Avg drive / day"}),(0,s.jsxs)("div",{className:"text-xl font-semibold",children:[eU.avg_drive_m_per_day.toFixed(0)," m"]})]}),(0,s.jsxs)("div",{className:"p-3 rounded-xl bg-muted",children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"Total CO₂ / day"}),(0,s.jsxs)("div",{className:"text-xl font-semibold",children:[eU.total_emissions_kg_per_day.toFixed(2)," kg"]})]}),(0,s.jsxs)("div",{className:"p-3 rounded-xl bg-muted",children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"Travel in (workers)"}),(0,s.jsx)("div",{className:"text-xl font-semibold",children:eU.travel_in})]})]}):(0,s.jsx)("p",{className:"text-muted-foreground",children:"Run the simulation to see results."})})]}),(0,s.jsxs)(x,{className:"bg-card border-border text-card-foreground",children:[(0,s.jsx)(g,{children:(0,s.jsx)(m,{children:"Visualization"})}),(0,s.jsx)(h,{children:eU?(0,s.jsx)("div",{className:"h-64",children:(0,s.jsx)(O.u,{width:"100%",height:"100%",children:(0,s.jsxs)(B.E,{data:eK,children:[(0,s.jsx)(D.W,{dataKey:"metric",tick:{fill:"var(--muted-foreground)"},interval:0,angle:-10,textAnchor:"end",height:50}),(0,s.jsx)(T.h,{tick:{fill:"var(--muted-foreground)"}}),(0,s.jsx)(V.m,{contentStyle:{background:"var(--popover)",border:"1px solid var(--border)"},labelStyle:{color:"var(--foreground)"}}),(0,s.jsx)(U.y,{dataKey:"value"})]})})}):(0,s.jsx)("p",{className:"text-muted-foreground",children:"Results will appear here as a chart."})})]})]})]})]})})}function J(){return(0,s.jsx)("div",{className:"min-h-screen",children:(0,s.jsx)(Q,{})})}function Q(){return(0,s.jsx)(q,{})}},9954:(e,r,t)=>{Promise.resolve().then(t.bind(t,9656))}},e=>{e.O(0,[780,441,255,358],()=>e(e.s=9954)),_N_E=e.O()}]);